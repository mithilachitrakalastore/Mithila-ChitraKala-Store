<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details - Mithila Chitrakala</title>
  <link rel="shortcut icon" href="assets/logo.png" type="image/x-icon">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&family=Dancing+Script:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo">Mithila Chitrakala</a>
      <ul class="nav-links">
        <li><a href="index.html" data-testid="link-home">Home</a></li>
        <li><a href="products.html" data-testid="link-products">Products</a></li>
        <li><a href="index.html/#about" data-testid="link-about">About</a></li>
        <li><a href="index.html/#contact" data-testid="link-contact">Contact</a></li>
      </ul>
      <a href="cart.html" class="cart-icon" data-testid="link-cart">
        <i class="fa-solid fa-cart-shopping"></i> Cart
        <span class="cart-count" data-testid="text-cart-count">0</span>
      </a>
    </div>
  </nav>

  <!-- Product Detail -->
  <main class="product-detail-page">
    <div class="container" style="margin-top: 120px; padding: 2rem;">
      <div class="breadcrumb" style="margin-bottom: 2rem;">
        <a href="products.html" class="back-link" data-testid="link-back-products">‚Üê Back to Products</a>
      </div>

      <div id="product-detail"></div>
    </div>
  </main>

  <script src="script.js"></script> <!-- loadProducts() & addToCart() -->

  <script>

   document.addEventListener("DOMContentLoaded", async () => {
  const params = new URLSearchParams(window.location.search);
  const slug = params.get("slug");
  const container = document.getElementById("product-detail");

  if (!slug) {
    container.innerHTML = "<p>No product selected.</p>";
    return;
  }

  if (!products || products.length === 0) {
    await loadProducts();
  }

  const product = products.find(p => p.slug === slug);
  if (!product) {
    container.innerHTML = "<p>Product not found.</p>";
    return;
  }

  // Collect all image keys
  const images = [product.image];
  if (product.image2) images.push(product.image2);
  if (product.image3) images.push(product.image3);
  if (product.image4) images.push(product.image4);

  container.innerHTML = `
    <div class="product-detail-grid">
      <div class="product-detail-image">
          <img id="slider-img" src="${images[0]}" alt="${product.name}" data-testid="img-product-detail" class="slide-in" />
          <button id="prev-btn" class="slider-btn" style="position:absolute;left:10px;top:50%;transform:translateY(-50%);">‚ùÆ</button>
          <button id="next-btn" class="slider-btn" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);">‚ùØ</button>
      </div>
      <div class="product-detail-info">
        <h1 class="product-detail-title" data-testid="text-product-title">${product.name}</h1>
        <p class="product-detail-description" data-testid="text-product-description">${product.description}</p>
        <p class="product-detail-store-name"><i class="fa-solid fa-store"></i> ${product.storeName}</p>
        <p class="product-detail-location"><i class="fa-solid fa-location-dot"></i>${product.location}</p>
        <p class="product-detail-rating"><i class="fa-solid fa-star"></i>${product.rating} Out of 5</p>
        <p class="product-detail-stock"><i class="fa-solid fa-box"></i> : ${product.stock}</p>
        <p class="explore-social-p">Watch This Product on:</p>
            <div class="explore-social">
            <a href="${product.tiktok}" class="explore-tiktok" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
            <a href="${product.instagram}" class="explore-insta" target="_blank"><i class="fa-brands fa-instagram"></i></a>
            <a href="${product.facebook}" class="explore-facebook" target="_blank"><i class="fa-brands fa-facebook"></i></a>
            </div>
        <div class="product-detail-price" data-testid="text-product-price">‡§∞‡•Å ${product.price}</div>
        <div class="product-actions">
          <button class="add-to-cart-detail" onclick="addToCart('${product.id}')" data-testid="button-add-to-cart">
                <i class="fa-solid fa-cart-arrow-down"></i> Add to Cart
          </button>
          <button class="share-button" onclick="shareProduct('${product.name}', '${product.description}', window.location.href)" data-testid="button-share-product">
            <i class="fa-solid fa-share"></i> Share
          </button>
        </div>
      </div>
    </div>
    <div class="product-detail">
          <h2>Product Details</h2>
          <p class="product-detail-full-description" data-testid="text-product-full-description">
            This exquisite Mithila painting wallet showcases the rich cultural heritage of the Mithila region. Handcrafted by skilled artisans, it features traditional motifs and vibrant colors that tell a story of nature and mythology. Made from high-quality materials, this wallet is not only a piece of art but also durable and functional. Perfect for those who appreciate fine craftsmanship and want to carry a piece of tradition with them.
          </p>
          <p class="area"><i class="fa-solid fa-maximize"></i><b>Lenght & width</b> = ${product.length}</p>
          <p class="material"><i class="fa-solid fa-palette"></i><b>Material</b> = ${product.material}</p>
          <p class="delivery"><i class="fa-regular fa-truck"></i><b>Delivery</b> = ${product.delivery}</p>
          <p class="care-instructions"><i class="fa-solid fa-hand-holding-droplet"></i><b>Care Instructions</b> = ${product.instruction}</p>
          <p class="authenticity"><i class="fa-solid fa-certificate"></i><b>Authenticity</b> = ${product.authenticity}</p>

        </div>
  `;

  // Slider logic
  let currentIndex = 0;
  const sliderImg = document.getElementById("slider-img");
  const prevBtn = document.getElementById("prev-btn");
  const nextBtn = document.getElementById("next-btn");

  function showImage(index, direction = "right") {
    sliderImg.classList.remove("slide-in", "slide-out");
    sliderImg.classList.add("slide-out");
    setTimeout(() => {
        sliderImg.src = images[index];
        sliderImg.classList.remove("slide-out");
        sliderImg.classList.add("slide-in-" + direction);
    }, 300);
  }

  prevBtn.onclick = () => {
    if (currentIndex > 0) {
      currentIndex--;
      showImage(currentIndex, "left");
    }
  };
  nextBtn.onclick = () => {
    if (currentIndex < images.length - 1) {
      currentIndex++;
      showImage(currentIndex, "right");
    }
  };

  // Hide buttons if only one image
  if (images.length <= 1) {
    prevBtn.style.display = "none";
    nextBtn.style.display = "none";
  }
});

</script>

  <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Mithila Chitrakala</h3>
                    <p style="color: #CBD5E0; margin-bottom: 1rem;">Preserving and promoting the ancient art of Mithila painting through authentic handcrafted artworks.</p>
                    <div id="contact" style="color: #A0AEC0;">
                        üìç Pidari, Janakpur, Nepal<br>
                        üìß info@mithilachitrakala.com<br>
                        üìû +977 9766115626
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Shop</h3>
                    <a href="products.html" data-testid="link-footer-products">All Products</a>
                    <a href="products.html?category=paintings" data-testid="link-footer-paintings">Paintings</a>
                    <a href="products.html?category=crafts" data-testid="link-footer-crafts">Crafts</a>
                    <a href="products.html?category=home-decor" data-testid="link-footer-home-decor">Home Decor</a>
                    <a href="products.html?category=clothings" data-testid="link-footer-home-decor">Clothings</a>
                    <a href="products.html?category=accessories" data-testid="link-footer-home-decor">Accessories</a>
                </div>
                
                <div class="footer-section">
                    <h3>Support</h3>
                    <a href="#about" data-testid="link-footer-about">About Us</a>
                    <a href="#contact" data-testid="link-footer-contact">Contact</a>
                    <a href="#shipping" data-testid="link-footer-shipping">Shipping Info</a>
                    <a href="#returns" data-testid="link-footer-returns">Returns</a>
                </div>
                
                <div class="footer-section">
                    <h3>Follow Us</h3>
                    <a href="https://www.tiktok.com/@mithila_chitrakala" data-testid="link-footer-tiktok">Tiktok</a>
                    <a href="https://www.instagram.com/mithilachitrakalastore" data-testid="link-footer-instagram">Instagram</a>
                    <a href="https://www.facebook.com/share/1GYroKQsDr/" data-testid="link-footer-facebook">Facebook</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Mithila Chitrakala. All rights reserved. | <a href="privacy-policy.html" target="_blank">Privacy Policy</a> | <a href="terms-and-conditions.html" target="_blank">Terms of Service</a></p>
            </div>
        </div>
    </footer>
</body>
</html>
